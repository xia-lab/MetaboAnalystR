/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.0.
 * Original file: /npm/d3-octree@1.0.2/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function t(t,i,n,s,r){if(isNaN(i)||isNaN(n)||isNaN(s))return t;var h,e,a,o,l,u,_,f,c,x,y,w,z=t._root,p={data:r},N=t._x0,d=t._y0,v=t._z0,g=t._x1,A=t._y1,b=t._z1;if(!z)return t._root=p,t;for(;z.length;)if((f=i>=(e=(N+g)/2))?N=e:g=e,(c=n>=(a=(d+A)/2))?d=a:A=a,(x=s>=(o=(v+b)/2))?v=o:b=o,h=z,!(z=z[y=x<<2|c<<1|f]))return h[y]=p,t;if(l=+t._x.call(null,z.data),u=+t._y.call(null,z.data),_=+t._z.call(null,z.data),i===l&&n===u&&s===_)return p.next=z,h?h[y]=p:t._root=p,t;do{h=h?h[y]=new Array(8):t._root=new Array(8),(f=i>=(e=(N+g)/2))?N=e:g=e,(c=n>=(a=(d+A)/2))?d=a:A=a,(x=s>=(o=(v+b)/2))?v=o:b=o}while((y=x<<2|c<<1|f)==(w=(_>=o)<<2|(u>=a)<<1|l>=e));return h[w]=z,h[y]=p,t}function i(t,i,n,s,r,h,e){this.node=t,this.x0=i,this.y0=n,this.z0=s,this.x1=r,this.y1=h,this.z1=e}function n(t){return t[0]}function s(t){return t[1]}function r(t){return t[2]}function h(t,i,h,a){var o=new e(null==i?n:i,null==h?s:h,null==a?r:a,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function e(t,i,n,s,r,h,e,a,o){this._x=t,this._y=i,this._z=n,this._x0=s,this._y0=r,this._z0=h,this._x1=e,this._y1=a,this._z1=o,this._root=void 0}function a(t){for(var i={data:t.data},n=i;t=t.next;)n=n.next={data:t.data};return i}var o=h.prototype=e.prototype;o.copy=function(){var t,i,n=new e(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),s=this._root;if(!s)return n;if(!s.length)return n._root=a(s),n;for(t=[{source:s,target:n._root=new Array(8)}];s=t.pop();)for(var r=0;r<8;++r)(i=s.source[r])&&(i.length?t.push({source:i,target:s.target[r]=new Array(8)}):s.target[r]=a(i));return n},o.add=function(i){const n=+this._x.call(null,i),s=+this._y.call(null,i),r=+this._z.call(null,i);return t(this.cover(n,s,r),n,s,r,i)},o.addAll=function(i){Array.isArray(i)||(i=Array.from(i));const n=i.length,s=new Float64Array(n),r=new Float64Array(n),h=new Float64Array(n);let e=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,_=-1/0;for(let t,f,c,x,y=0;y<n;++y)isNaN(f=+this._x.call(null,t=i[y]))||isNaN(c=+this._y.call(null,t))||isNaN(x=+this._z.call(null,t))||(s[y]=f,r[y]=c,h[y]=x,f<e&&(e=f),f>l&&(l=f),c<a&&(a=c),c>u&&(u=c),x<o&&(o=x),x>_&&(_=x));if(e>l||a>u||o>_)return this;this.cover(e,a,o).cover(l,u,_);for(let e=0;e<n;++e)t(this,s[e],r[e],h[e],i[e]);return this},o.cover=function(t,i,n){if(isNaN(t=+t)||isNaN(i=+i)||isNaN(n=+n))return this;var s=this._x0,r=this._y0,h=this._z0,e=this._x1,a=this._y1,o=this._z1;if(isNaN(s))e=(s=Math.floor(t))+1,a=(r=Math.floor(i))+1,o=(h=Math.floor(n))+1;else{for(var l,u,_=e-s||1,f=this._root;s>t||t>=e||r>i||i>=a||h>n||n>=o;)switch(u=(n<h)<<2|(i<r)<<1|t<s,(l=new Array(8))[u]=f,f=l,_*=2,u){case 0:e=s+_,a=r+_,o=h+_;break;case 1:s=e-_,a=r+_,o=h+_;break;case 2:e=s+_,r=a-_,o=h+_;break;case 3:s=e-_,r=a-_,o=h+_;break;case 4:e=s+_,a=r+_,h=o-_;break;case 5:s=e-_,a=r+_,h=o-_;break;case 6:e=s+_,r=a-_,h=o-_;break;case 7:s=e-_,r=a-_,h=o-_}this._root&&this._root.length&&(this._root=f)}return this._x0=s,this._y0=r,this._z0=h,this._x1=e,this._y1=a,this._z1=o,this},o.data=function(){var t=[];return this.visit((function(i){if(!i.length)do{t.push(i.data)}while(i=i.next)})),t},o.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},o.find=function(t,n,s,r){var h,e,a,o,l,u,_,f,c,x=this._x0,y=this._y0,w=this._z0,z=this._x1,p=this._y1,N=this._z1,d=[],v=this._root;for(v&&d.push(new i(v,x,y,w,z,p,N)),null==r?r=1/0:(x=t-r,y=n-r,w=s-r,z=t+r,p=n+r,N=s+r,r*=r);f=d.pop();)if(!(!(v=f.node)||(e=f.x0)>z||(a=f.y0)>p||(o=f.z0)>N||(l=f.x1)<x||(u=f.y1)<y||(_=f.z1)<w))if(v.length){var g=(e+l)/2,A=(a+u)/2,b=(o+_)/2;d.push(new i(v[7],g,A,b,l,u,_),new i(v[6],e,A,b,g,u,_),new i(v[5],g,a,b,l,A,_),new i(v[4],e,a,b,g,A,_),new i(v[3],g,A,o,l,u,b),new i(v[2],e,A,o,g,u,b),new i(v[1],g,a,o,l,A,b),new i(v[0],e,a,o,g,A,b)),(c=(s>=b)<<2|(n>=A)<<1|t>=g)&&(f=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=f)}else{var k=t-+this._x.call(null,v.data),m=n-+this._y.call(null,v.data),M=s-+this._z.call(null,v.data),F=k*k+m*m+M*M;if(F<r){var q=Math.sqrt(r=F);x=t-q,y=n-q,w=s-q,z=t+q,p=n+q,N=s+q,h=v.data}}return h},o.remove=function(t){if(isNaN(h=+this._x.call(null,t))||isNaN(e=+this._y.call(null,t))||isNaN(a=+this._z.call(null,t)))return this;var i,n,s,r,h,e,a,o,l,u,_,f,c,x,y,w=this._root,z=this._x0,p=this._y0,N=this._z0,d=this._x1,v=this._y1,g=this._z1;if(!w)return this;if(w.length)for(;;){if((_=h>=(o=(z+d)/2))?z=o:d=o,(f=e>=(l=(p+v)/2))?p=l:v=l,(c=a>=(u=(N+g)/2))?N=u:g=u,i=w,!(w=w[x=c<<2|f<<1|_]))return this;if(!w.length)break;(i[x+1&7]||i[x+2&7]||i[x+3&7]||i[x+4&7]||i[x+5&7]||i[x+6&7]||i[x+7&7])&&(n=i,y=x)}for(;w.data!==t;)if(s=w,!(w=w.next))return this;return(r=w.next)&&delete w.next,s?(r?s.next=r:delete s.next,this):i?(r?i[x]=r:delete i[x],(w=i[0]||i[1]||i[2]||i[3]||i[4]||i[5]||i[6]||i[7])&&w===(i[7]||i[6]||i[5]||i[4]||i[3]||i[2]||i[1]||i[0])&&!w.length&&(n?n[y]=w:this._root=w),this):(this._root=r,this)},o.removeAll=function(t){for(var i=0,n=t.length;i<n;++i)this.remove(t[i]);return this},o.root=function(){return this._root},o.size=function(){var t=0;return this.visit((function(i){if(!i.length)do{++t}while(i=i.next)})),t},o.visit=function(t){var n,s,r,h,e,a,o,l,u=[],_=this._root;for(_&&u.push(new i(_,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=u.pop();)if(!t(_=n.node,r=n.x0,h=n.y0,e=n.z0,a=n.x1,o=n.y1,l=n.z1)&&_.length){var f=(r+a)/2,c=(h+o)/2,x=(e+l)/2;(s=_[7])&&u.push(new i(s,f,c,x,a,o,l)),(s=_[6])&&u.push(new i(s,r,c,x,f,o,l)),(s=_[5])&&u.push(new i(s,f,h,x,a,c,l)),(s=_[4])&&u.push(new i(s,r,h,x,f,c,l)),(s=_[3])&&u.push(new i(s,f,c,e,a,o,x)),(s=_[2])&&u.push(new i(s,r,c,e,f,o,x)),(s=_[1])&&u.push(new i(s,f,h,e,a,c,x)),(s=_[0])&&u.push(new i(s,r,h,e,f,c,x))}return this},o.visitAfter=function(t){var n,s=[],r=[];for(this._root&&s.push(new i(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=s.pop();){var h=n.node;if(h.length){var e,a=n.x0,o=n.y0,l=n.z0,u=n.x1,_=n.y1,f=n.z1,c=(a+u)/2,x=(o+_)/2,y=(l+f)/2;(e=h[0])&&s.push(new i(e,a,o,l,c,x,y)),(e=h[1])&&s.push(new i(e,c,o,l,u,x,y)),(e=h[2])&&s.push(new i(e,a,x,l,c,_,y)),(e=h[3])&&s.push(new i(e,c,x,l,u,_,y)),(e=h[4])&&s.push(new i(e,a,o,y,c,x,f)),(e=h[5])&&s.push(new i(e,c,o,y,u,x,f)),(e=h[6])&&s.push(new i(e,a,x,y,c,_,f)),(e=h[7])&&s.push(new i(e,c,x,y,u,_,f))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this},o.x=function(t){return arguments.length?(this._x=t,this):this._x},o.y=function(t){return arguments.length?(this._y=t,this):this._y},o.z=function(t){return arguments.length?(this._z=t,this):this._z};export{h as octree};export default null;
