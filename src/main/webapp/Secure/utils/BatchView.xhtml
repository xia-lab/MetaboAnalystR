<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="#{sessionBean1.templatePath}">
    <ui:define name="metaInfo">
        <f:event type="preRenderView" listener="#{sessionBean1.initNaviTree('utils')}"/> 
        <f:event type="preRenderView" listener="#{sessionBean1.addNaviTrack('Batch View', '/Secure/utils/BatchView.xhtml')}"/> 
    </ui:define>
    <ui:define name="content">
        <h:panelGrid styleClass="my-content-panel">
            <h3>
                Batch Effect Adjustment View
            </h3>
            <h:panelGrid style="width: 95%; padding: 20px 20px 20px 60px">
                <p style="font-size: 1.2rem">Principal Component Analysis (PCA) showing general profile before and after correction:</p>
                <img onerror='this.style.display="none"' 
                     style="height:6in;"
                     src="#{sessionBean1.getCurrentImageURL('batch')}" alt="BatchImage"/>
                <br/><br/>
                <p style="font-size: 1.2rem">Singular value decomposition (SVD) analysis applied to find systematic trends attributable to bias:</p>
                <img onerror='this.style.display="none"' 
                     style="height:6in;"
                     src="#{batchLoader.getBatchImg('trend_dpi150')}" alt="BatchImage2"/>
                <br/><br/>
                <p style="font-size: 1.2rem">Distance among all sample batches before and after correction:</p>
                <img onerror='this.style.display="none"' 
                     style="height:5in;"
                     src="#{batchLoader.getBatchImg('dist_dpi150')}" alt="BatchImage3"/>

                <h:form>   
                    <h:panelGrid columns="2" style="padding-top: 20px;">
                        <h:outputText style="font-size: 1.2rem" value="Download the batch corrected data table "/>
                        <p:commandButton styleClass="ui-button-outlined ui-button-success" value="Download" ajax="false">
                            <p:fileDownload value="#{batchLoader.correctedFile}" />
                        </p:commandButton>    
                    </h:panelGrid>  
                </h:form>
            </h:panelGrid>


        </h:panelGrid>
    </ui:define>
</ui:composition>


