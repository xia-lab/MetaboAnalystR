<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="#{sessionBean1.templatePath}">
    <ui:define name="metaInfo">
        <f:event type="preRenderView"  listener="#{sessionBean1.addNaviTrack('Set parameter', '/Secure/roc/MultiParam.xhtml')}"/> 
    </ui:define>
    <ui:define name="footerout"/>
    <ui:define name="content">
        <h:panelGrid styleClass="my-content-panel">
            <h2>
                Multivariate Exploratory ROC Analysis Overview
            </h2>
            <p>
                ROC curves are generated by Monte-Carlo cross validation (MCCV) using balanced sub-sampling. 
                In each MCCV, two thirds (2/3) of the samples are used to evaluate the feature importance. 
                The top 2, 3, 5, 10 ...100 (max) important features are then used to build classification models 
                which is validated on the 1/3 the samples that were left out. The procedure were repeated 
                multiple times to calculate the performance and confidence interval of each model. 
            </p>
            <p>
                Users need to specify the <b>classification method</b> and <b>feature ranking method</b>.
                For the feature ranking method, the first two are univariate approaches, the last three are 
                built-in methods for corresponding classification method. Note for large dataset (> 1000 features), 
                the univairate feature ranking method should be used to save computational time. For PLS-DA algorithm, 
                users can further specify the number of latent variables (LV) to use. If the given number is higher than 
                the actual feature number, the value will be ignored and default 2 LV will be used.
            </p> 
            <h:form id="summaryForm">
                <h:panelGrid columns="2">
                    <h:panelGrid columns="2" cellpadding="4" style="margin: 10px 60px 20px 40px">
                        <h:panelGroup layout="block" style="width:180px">
                            <h:outputLabel for="meta1" style="font-weight: bold;" value="Selected metadata:"/>
                        </h:panelGroup>
                        <p:selectOneMenu id="meta1" styleClass="menu" panelStyleClass="panel" value="#{rocAnalBean.selMeta}">
                            <f:selectItems value="#{multifacBean.discreteMetaOpts}" />
                            <p:ajax listener="#{rocAnalBean.analysisMetaChangeListener()}" event="change" update="summaryForm"/> 
                        </p:selectOneMenu>

                        <h:outputLabel style="font-weight: bold;" value="Target group:"/>
                        <p:selectOneMenu style="width:140px" styleClass="menu" panelStyleClass="panel" value="#{rocAnalBean.factor1}">
                            <f:selectItems value="#{multifacBean.uniqueMetaList}" />
                        </p:selectOneMenu>

                        <h:outputLabel style="font-weight: bold;" value="Reference group:"/>
                        <p:selectOneMenu style="width:140px" styleClass="menu" panelStyleClass="panel" value="#{rocAnalBean.factor2}">
                            <f:selectItem itemLabel="ALL others" itemValue="all" />
                            <f:selectItems value="#{multifacBean.uniqueMetaList}" /> 
                        </p:selectOneMenu>
                        <h:panelGroup layout="block" style="width:220px" >
                            <h:outputLabel style="font-weight: bold" value="Classification method:"/>
                        </h:panelGroup>
                        <p:selectOneMenu  styleClass="menu" panelStyleClass="panel" value="#{rocAnalBean.clsMethodOpt}">
                            <f:selectItem itemLabel="Linear SVM" itemValue="svm" />
                            <f:selectItem itemLabel="PLS-DA" itemValue="pls" />
                            <f:selectItem itemLabel="Random Forests" itemValue="rf" />
                        </p:selectOneMenu>

                        <h:outputLabel style="font-weight: bold" value="Feature ranking method:"/>
                        <p:selectOneMenu styleClass="menu" panelStyleClass="panel" value="#{rocAnalBean.featRankOpt}">
                            <f:selectItem itemLabel= "Univariate AUROC" itemValue="auroc" />
                            <f:selectItem itemLabel= "T-statistic" itemValue="tt" />
                            <!--
                            <f:selectItem itemLabel= "Fisher's Exact test" itemValue="fisher" />
                            -->
                            <f:selectItem itemLabel="SVM built-in" itemValue="svm" />
                            <f:selectItem itemLabel="PLS-DA built-in" itemValue="pls" />
                            <f:selectItem itemLabel="RandomForest built-in" itemValue="rf" />
                        </p:selectOneMenu>

                        <h:outputLabel style="font-weight: bold" value="Number of latent variables"/>
                        <h:panelGroup>
                            <p:inputText style="width: 60px" value="#{rocAnalBean.lvNum}" required="true"
                                         requiredMessage="Must set component"/>
                            <p:spacer style="width:5px"/>
                            <h:outputText value="(PLSDA only)"/>
                        </h:panelGroup>
                    </h:panelGrid>
                    <p:commandButton value="Submit" ajax="false"
                                     onclick="PF('statusDialog').show()" 
                                     oncomplete="PF('statusDialog').hide()" 
                                     action="#{rocAnalBean.performExploreAnalysis()}"/>  

                </h:panelGrid>
            </h:form>
        </h:panelGrid> 
    </ui:define>
</ui:composition>

