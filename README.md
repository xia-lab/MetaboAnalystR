# MetaboAnalyst Pro

<p align="center">
  <img src="https://github.com/xia-lab/MetaboAnalystR/blob/master/inst/docs/MetaboAnalystRlogo.png">
</p>

## Job Scheduler - Quartz 

psql -h localhost -p 5432 -U quartz -d quartzdb

# Install PostgreSQL

Please follow this tutorial to install PostgrSQL: https://www.postgresql.org/download/



# Configure PostgreSQL for Quartz
```sql
 create user quartz with password 'quartz_xialab_$Omics!';
 create database quartzdb with owner quartz;
 \c quartzdb quartz
 
CREATE TABLE IF NOT EXISTS workflow_job_status (
    job_id        VARCHAR(255) PRIMARY KEY,
    token         VARCHAR(255),
    status        VARCHAR(100),
    updated_time  TIMESTAMP WITHOUT TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP
);
 
 GRANT ALL ON SCHEMA public TO quartz;
 
   CREATE TABLE QRTZ_LOCKS (
    SCHED_NAME VARCHAR(120) NOT NULL,
    LOCK_NAME VARCHAR(40) NOT NULL,
    PRIMARY KEY (SCHED_NAME, LOCK_NAME)
);

  CREATE TABLE QRTZ_SCHEDULER_STATE (
      SCHED_NAME VARCHAR(120) NOT NULL,
      INSTANCE_NAME VARCHAR(200) NOT NULL,
      LAST_CHECKIN_TIME BIGINT NOT NULL,
      CHECKIN_INTERVAL BIGINT NOT NULL,
      PRIMARY KEY (SCHED_NAME, INSTANCE_NAME)
  );
  
  CREATE TABLE QRTZ_JOB_DETAILS (
      SCHED_NAME VARCHAR(120) NOT NULL,
      JOB_NAME VARCHAR(200) NOT NULL,
      JOB_GROUP VARCHAR(200) NOT NULL,
      DESCRIPTION VARCHAR(250) NULL,
      JOB_CLASS_NAME VARCHAR(250) NOT NULL,
      IS_DURABLE BOOLEAN NOT NULL,
      IS_NONCONCURRENT BOOLEAN NOT NULL,
      IS_UPDATE_DATA BOOLEAN NOT NULL,
      REQUESTS_RECOVERY BOOLEAN NOT NULL,
      JOB_DATA BYTEA NULL,
      PRIMARY KEY (SCHED_NAME, JOB_NAME, JOB_GROUP)
  );
  
  CREATE TABLE QRTZ_TRIGGERS (
      SCHED_NAME VARCHAR(120) NOT NULL,
      TRIGGER_NAME VARCHAR(200) NOT NULL,
      TRIGGER_GROUP VARCHAR(200) NOT NULL,
      JOB_NAME VARCHAR(200) NOT NULL,
      JOB_GROUP VARCHAR(200) NOT NULL,
      DESCRIPTION VARCHAR(250) NULL,
      NEXT_FIRE_TIME BIGINT NULL,
      PREV_FIRE_TIME BIGINT NULL,
      PRIORITY INTEGER NULL,
      TRIGGER_STATE VARCHAR(16) NOT NULL,
      TRIGGER_TYPE VARCHAR(8) NOT NULL,
      START_TIME BIGINT NOT NULL,
      END_TIME BIGINT NULL,
      CALENDAR_NAME VARCHAR(200) NULL,
      MISFIRE_INSTR INTEGER NULL,
      JOB_DATA BYTEA NULL,
      PRIMARY KEY (SCHED_NAME, TRIGGER_NAME, TRIGGER_GROUP)
  );
  
  CREATE TABLE QRTZ_SCHEDULER_STATE (
      SCHED_NAME VARCHAR(120) NOT NULL,
      INSTANCE_NAME VARCHAR(200) NOT NULL,
      LAST_CHECKIN_TIME BIGINT NOT NULL,
      CHECKIN_INTERVAL BIGINT NOT NULL,
      PRIMARY KEY (SCHED_NAME, INSTANCE_NAME)
  );
  
  CREATE TABLE QRTZ_PAUSED_TRIGGER_GRPS (
      SCHED_NAME VARCHAR(120) NOT NULL,
      TRIGGER_GROUP VARCHAR(200) NOT NULL,
      PRIMARY KEY (SCHED_NAME, TRIGGER_GROUP)
  );                                    
                                       
  CREATE TABLE QRTZ_FIRED_TRIGGERS (
      SCHED_NAME VARCHAR(120) NOT NULL,
      ENTRY_ID VARCHAR(95) NOT NULL,
      TRIGGER_NAME VARCHAR(200) NOT NULL,
      TRIGGER_GROUP VARCHAR(200) NOT NULL,
      INSTANCE_NAME VARCHAR(200) NOT NULL,
      FIRED_TIME BIGINT NOT NULL,
      SCHED_TIME BIGINT NOT NULL,
      PRIORITY INTEGER NOT NULL,
      STATE VARCHAR(16) NOT NULL,
      JOB_NAME VARCHAR(200) NULL,
      JOB_GROUP VARCHAR(200) NULL,
      IS_NONCONCURRENT BOOLEAN NULL,
      REQUESTS_RECOVERY BOOLEAN NULL,
      PRIMARY KEY (SCHED_NAME, ENTRY_ID)
  );
  
  CREATE TABLE QRTZ_SIMPLE_TRIGGERS (
      SCHED_NAME VARCHAR(120) NOT NULL,
      TRIGGER_NAME VARCHAR(200) NOT NULL,
      TRIGGER_GROUP VARCHAR(200) NOT NULL,
      REPEAT_COUNT BIGINT NOT NULL,
      REPEAT_INTERVAL BIGINT NOT NULL,
      TIMES_TRIGGERED BIGINT NOT NULL,
      PRIMARY KEY (SCHED_NAME, TRIGGER_NAME, TRIGGER_GROUP),
      FOREIGN KEY (SCHED_NAME, TRIGGER_NAME, TRIGGER_GROUP)
          REFERENCES QRTZ_TRIGGERS(SCHED_NAME, TRIGGER_NAME, TRIGGER_GROUP)
          ON DELETE CASCADE
  );



```
